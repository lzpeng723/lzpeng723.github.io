(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{684:function(e,v,_){"use strict";_.r(v);var r=_(10),t=Object(r.a)({},(function(){var e=this,v=e.$createElement,_=e._self._c||v;return _("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[_("h1",{attrs:{id:"docker-清理"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#docker-清理"}},[e._v("#")]),e._v(" Docker 清理")]),e._v(" "),_("h2",{attrs:{id:"容器清理"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#容器清理"}},[e._v("#")]),e._v(" 容器清理")]),e._v(" "),_("ul",[_("li",[_("code",[e._v("docker container prune")]),e._v(" :  仅删除停止运行的容器。")]),e._v(" "),_("li",[_("code",[e._v("docker rm -f $(docker ps -aq)")]),e._v(" :  删除所有容器（包括停止的、正在运行的）。")]),e._v(" "),_("li",[_("code",[e._v("docker container rm -f $(docker container ls -aq)")]),e._v(" :  同上。")])]),e._v(" "),_("h2",{attrs:{id:"镜像清理"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#镜像清理"}},[e._v("#")]),e._v(" 镜像清理")]),e._v(" "),_("p",[_("code",[e._v("docker rmi <image id>")]),e._v(" ：通过镜像的id来删除指定镜像。")]),e._v(" "),_("p",[e._v("有一些镜像是隐形的：")]),e._v(" "),_("ul",[_("li",[e._v("子镜像，就是被其他镜像引用的中间镜像，不能被删除。")]),e._v(" "),_("li",[e._v("悬挂状态的镜像，就是不会再被使用的镜像，可以被删除。")])]),e._v(" "),_("p",[e._v("其他命令：")]),e._v(" "),_("ul",[_("li",[_("code",[e._v("docker image ls -f dangling=true")]),e._v(" : 可以列出所有悬挂状态的镜像\n并使用命令 "),_("code",[e._v("docker image rm $(docker image ls -f dangling=true -q)")]),e._v(" 或 "),_("code",[e._v("docker image prune")]),e._v("进行删除。")]),e._v(" "),_("li",[_("code",[e._v("docker image rm $(docker image ls -q)")]),e._v(" ：删除所有镜像。但正在被容器使用的镜像无法删除。")])]),e._v(" "),_("h2",{attrs:{id:"数据卷清理"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#数据卷清理"}},[e._v("#")]),e._v(" 数据卷清理")]),e._v(" "),_("ul",[_("li",[_("code",[e._v("docker volume rm $(docker volume ls -q)")]),e._v(" ：删除不再使用的数据卷。")]),e._v(" "),_("li",[_("code",[e._v("docker volume prune")]),e._v(" ：同上。")])]),e._v(" "),_("h2",{attrs:{id:"缓存清理"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#缓存清理"}},[e._v("#")]),e._v(" 缓存清理")]),e._v(" "),_("p",[_("strong",[e._v("Docker 18.09")]),e._v(" 引入了 "),_("strong",[e._v("BuildKit")]),e._v(" ，提升了构建过程的性能、安全、存储管理等能力。")]),e._v(" "),_("p",[_("code",[e._v("docker builder prune")]),e._v(" ：删除 build cache。")]),e._v(" "),_("h2",{attrs:{id:"一键清理"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#一键清理"}},[e._v("#")]),e._v(" 一键清理")]),e._v(" "),_("p",[_("code",[e._v("docker system df")]),e._v(" 命令，类似于 "),_("strong",[e._v("Linux")]),e._v("上的 "),_("code",[e._v("df")]),e._v(" 命令，用于查看 "),_("strong",[e._v("Docker")]),e._v(" 的磁盘使用情况：")]),e._v(" "),_("div",{staticClass:"language- line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[e._v("docker system df\n")])]),e._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[e._v("1")]),_("br")])]),_("p",[_("strong",[e._v("TYPE")]),e._v("列出了 "),_("strong",[e._v("Docker")]),e._v(" 使用磁盘的 "),_("strong",[e._v("4")]),e._v(" 种类型：")]),e._v(" "),_("ul",[_("li",[_("strong",[e._v("Images")]),e._v(" ：所有镜像占用的空间，包括拉取下来的镜像，和本地构建的。")]),e._v(" "),_("li",[_("strong",[e._v("Containers")]),e._v(" ：运行的容器占用的空间，表示每个容器的读写层的空间。")]),e._v(" "),_("li",[_("strong",[e._v("Local Volumes")]),e._v(" ：容器挂载本地数据卷的空间。")]),e._v(" "),_("li",[_("strong",[e._v("Build Cache")]),e._v(" ：镜像构建过程中产生的缓存空间（只有在使用 "),_("strong",[e._v("BuildKit")]),e._v(" 时才有，"),_("strong",[e._v("Docker 18.09")]),e._v(" 以后可用）。")])]),e._v(" "),_("p",[e._v("最后的 "),_("strong",[e._v("RECLAIMABLE")]),e._v(" 是可回收大小。")]),e._v(" "),_("ul",[_("li",[_("code",[e._v("docker system prune")]),e._v(" : 可以用于清理磁盘，删除关闭的容器、无用的数据卷和网络，以及 "),_("strong",[e._v("dangling")]),e._v(" 镜像（即无 "),_("strong",[e._v("tag")]),e._v(" 的镜像）。")]),e._v(" "),_("li",[_("code",[e._v("docker system prune -a")]),e._v(" : 清理得更加彻底，可以将没有容器使用 "),_("strong",[e._v("Docker")]),e._v("镜像都删掉。\n注意，这两个命令会把你暂时关闭的容器，以及暂时没有用到的 "),_("strong",[e._v("Docker")]),e._v(" 镜像都删掉了。")])]),e._v(" "),_("p",[e._v("定期清理没用的数据，是个好习惯！")])])}),[],!1,null,null,null);v.default=t.exports}}]);