(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{554:function(s,a,e){s.exports=e.p+"assets/img/image-20200520144548997.38880d5b.png"},555:function(s,a,e){s.exports=e.p+"assets/img/image-20200520144959353.6ea0cd70.png"},556:function(s,a,e){s.exports=e.p+"assets/img/image-20200520154628679.008bd821.png"},557:function(s,a,e){s.exports=e.p+"assets/img/image-20200520162605102.26a03a73.png"},558:function(s,a,e){s.exports=e.p+"assets/img/image-20200520163253644.5df6652f.png"},559:function(s,a,e){s.exports=e.p+"assets/img/image-20200520163552110.c277dfdb.png"},560:function(s,a,e){s.exports=e.p+"assets/img/image-20200520163832827.d53635fb.png"},675:function(s,a,e){"use strict";e.r(a);var t=e(10),n=Object(t.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[t("a",{attrs:{href:"https://gitee.com/yooome/golang/blob/main/k8s%E8%AF%A6%E7%BB%86%E6%95%99%E7%A8%8B/Kubernetes%E8%AF%A6%E7%BB%86%E6%95%99%E7%A8%8B.md#10-dashboard",target:"_blank",rel:"noopener noreferrer"}},[s._v("原文链接"),t("OutboundLink")],1),s._v(" "),t("a",{attrs:{href:"https://www.bilibili.com/video/BV1Qv41167ck?p=84",target:"_blank",rel:"noopener noreferrer"}},[s._v("视频教程"),t("OutboundLink")],1)]),s._v(" "),t("h1",{attrs:{id:"_10-dashboard"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_10-dashboard"}},[s._v("#")]),s._v(" 10. DashBoard")]),s._v(" "),t("p",[s._v("之前在kubernetes中完成的所有操作都是通过命令行工具kubectl完成的。其实，为了提供更丰富的用户体验，kubernetes还开发了一个基于web的用户界面（Dashboard）。用户可以使用Dashboard部署容器化的应用，还可以监控应用的状态，执行故障排查以及管理kubernetes中各种资源。")]),s._v(" "),t("h2",{attrs:{id:"_10-1-部署dashboard"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_10-1-部署dashboard"}},[s._v("#")]),s._v(" 10.1 部署Dashboard")]),s._v(" "),t("ol",[t("li",[t("a",{attrs:{href:"https://raw.githubusercontent.com/kubernetes/dashboard/v2.4.0/aio/deploy/recommended.yaml",target:"_blank",rel:"noopener noreferrer"}},[s._v("下载yaml"),t("OutboundLink")],1),s._v(",修改镜像,并运行Dashboard")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("docker pull registry.cn-hangzhou.aliyuncs.com/kubernetes_ns/metrics-scraper:v1.0.4\ndocker pull registry.cn-hangzhou.aliyuncs.com/kubernetes_ns/dashboard:v2.0.3\ndocker save -o k8s-dashboard-images.tar "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("docker images "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" kubernetes_ns "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'BEGIN{OFS=":";ORS=" "}{print $1,$2}\'')]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("将yaml文件中的")]),s._v(" "),t("p",[t("code",[s._v("kubernetesui/metrics-scraper:v1.0.7")]),s._v("替换为"),t("code",[s._v("registry.cn-hangzhou.aliyuncs.com/kubernetes_ns/metrics-scraper:v1.0.4")])]),s._v(" "),t("p",[t("code",[s._v("kubernetesui/dashboard:v2.4.0")]),s._v("替换为"),t("code",[s._v("registry.cn-hangzhou.aliyuncs.com/kubernetes_ns/dashboard:v2.0.3")])]),s._v(" "),t("p",[s._v("修改 Service 配置")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Service\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("labels")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("k8s-app")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" kubernetes"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("dashboard\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" kubernetes"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("dashboard\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("namespace")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" kubernetes"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("dashboard\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" NodePort  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 新增")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("port")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("targetPort")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8443")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("nodePort")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("32100")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 新增")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("selector")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("k8s-app")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" kubernetes"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("dashboard\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 部署")]),s._v("\nkubectl create -f recommended.yaml\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看namespace下的kubernetes-dashboard下的资源")]),s._v("\nkubectl get pod,svc -n kubernetes-dashboard\n\nNAME                                            READY   STATUS    RESTARTS   AGE\npod/dashboard-metrics-scraper-c79c65bb7-zwfvw   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          111s\npod/kubernetes-dashboard-56484d4c5-z95z5        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          111s\n\nNAME                               TYPE       CLUSTER-IP      EXTERNAL-IP  PORT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("S"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("         AGE\nservice/dashboard-metrics-scraper  ClusterIP  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.96")]),s._v(".89.218    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),s._v("/TCP        111s\nservice/kubernetes-dashboard       NodePort   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.104")]),s._v(".178.171  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),s._v(":30009/TCP   111s\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("p",[s._v("2）创建访问账户，获取token")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建账号")]),s._v("\nkubectl create serviceaccount dashboard-admin -n kubernetes-dashboard\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 授权")]),s._v("\nkubectl create clusterrolebinding dashboard-admin-rb --clusterrole"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("cluster-admin --serviceaccount"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("kubernetes-dashboard:dashboard-admin\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 获取账号token")]),s._v("\nkubectl -n kubernetes-dashboard describe secret "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("kubectl -n kubernetes-dashboard get secret "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" dashboard-admin "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{print $1}'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n\nName:         dashboard-admin-token-xbqhh\nNamespace:    kubernetes-dashboard\nLabels:       "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nAnnotations:  kubernetes.io/service-account.name: dashboard-admin\n              kubernetes.io/service-account.uid: 95d84d80-be7a-4d10-a2e0-68f90222d039\n\nType:  kubernetes.io/service-account-token\n\nData\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v("\nnamespace:  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(" bytes\ntoken:      eyJhbGciOiJSUzI1NiIsImtpZCI6ImJrYkF4bW5XcDhWcmNGUGJtek5NODFuSXl1aWptMmU2M3o4LTY5a2FKS2cifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlcm5ldGVzLWRhc2hib2FyZCIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJkYXNoYm9hcmQtYWRtaW4tdG9rZW4teGJxaGgiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC5uYW1lIjoiZGFzaGJvYXJkLWFkbWluIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQudWlkIjoiOTVkODRkODAtYmU3YS00ZDEwLWEyZTAtNjhmOTAyMjJkMDM5Iiwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50Omt1YmVybmV0ZXMtZGFzaGJvYXJkOmRhc2hib2FyZC1hZG1pbiJ9.NAl7e8ZfWWdDoPxkqzJzTB46sK9E8iuJYnUI9vnBaY3Jts7T1g1msjsBnbxzQSYgAG--cV0WYxjndzJY_UWCwaGPrQrt_GunxmOK9AUnzURqm55GR2RXIZtjsWVP2EBatsDgHRmuUbQvTFOvdJB4x3nXcYLN2opAaMqg3rnU2rr-A8zCrIuX_eca12wIp_QiuP3SF-tzpdLpsyRfegTJZl6YnSGyaVkC9id-cxZRb307qdCfXPfCHR_2rt5FVfxARgg_C0e3eFHaaYQO7CitxsnIoIXpOFNAR8aUrmopJyODQIPqBWUehb7FhlU1DCduHnIIXVC_UICZ-MKYewBDLw\nca.crt:     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1025")]),s._v(" bytes\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br")])]),t("p",[s._v("3）通过浏览器访问Dashboard的UI")]),s._v(" "),t("p",[s._v("在登录页面上输入上面的token")]),s._v(" "),t("p",[t("img",{attrs:{src:e(554),alt:"image-20200520144548997"}})]),s._v(" "),t("p",[s._v("出现下面的页面代表成功")]),s._v(" "),t("p",[t("img",{attrs:{src:e(555),alt:"image-20200520144959353"}})]),s._v(" "),t("h2",{attrs:{id:"_10-2-使用dashboard"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_10-2-使用dashboard"}},[s._v("#")]),s._v(" 10.2 使用DashBoard")]),s._v(" "),t("p",[s._v("本章节以Deployment为例演示DashBoard的使用")]),s._v(" "),t("p",[t("strong",[s._v("查看")])]),s._v(" "),t("p",[s._v("选择指定的命名空间"),t("code",[s._v("dev")]),s._v("，然后点击"),t("code",[s._v("Deployments")]),s._v("，查看dev空间下的所有deployment")]),s._v(" "),t("p",[t("img",{attrs:{src:e(556),alt:"img"}})]),s._v(" "),t("p",[t("strong",[s._v("扩缩容")])]),s._v(" "),t("p",[s._v("在"),t("code",[s._v("Deployment")]),s._v("上点击"),t("code",[s._v("规模")]),s._v("，然后指定"),t("code",[s._v("目标副本数量")]),s._v("，点击确定")]),s._v(" "),t("p",[t("img",{attrs:{src:e(557),alt:"img"}})]),s._v(" "),t("p",[t("strong",[s._v("编辑")])]),s._v(" "),t("p",[s._v("在"),t("code",[s._v("Deployment")]),s._v("上点击"),t("code",[s._v("编辑")]),s._v("，然后修改"),t("code",[s._v("yaml文件")]),s._v("，点击确定")]),s._v(" "),t("p",[t("img",{attrs:{src:e(558),alt:"image-20200520163253644"}})]),s._v(" "),t("p",[t("strong",[s._v("查看Pod")])]),s._v(" "),t("p",[s._v("点击"),t("code",[s._v("Pods")]),s._v(", 查看pods列表")]),s._v(" "),t("p",[t("img",{attrs:{src:e(559),alt:"img"}})]),s._v(" "),t("p",[t("strong",[s._v("操作Pod")])]),s._v(" "),t("p",[s._v("选中某个Pod，可以对其执行日志（logs）、进入执行（exec）、编辑、删除操作")]),s._v(" "),t("p",[t("img",{attrs:{src:e(560),alt:"img"}})]),s._v(" "),t("blockquote",[t("p",[s._v("Dashboard提供了kubectl的绝大部分功能，这里不再一一演示")])])])}),[],!1,null,null,null);a.default=n.exports}}]);