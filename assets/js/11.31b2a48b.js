(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{556:function(s,a,n){s.exports=n.p+"assets/img/image-20200407100850484.5c0ca682.png"},557:function(s,a,n){s.exports=n.p+"assets/img/image-20200407121501907.f2c6952c.png"},558:function(s,a,n){s.exports=n.p+"assets/img/image-20200408193950807.cbf7a130.png"},559:function(s,a,n){s.exports=n.p+"assets/img/image-20200408194716912.934ff829.png"},634:function(s,a,n){"use strict";n.r(a);var e=n(10),t=Object(e.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("p",[e("a",{attrs:{href:"https://gitee.com/yooome/golang/blob/main/k8s%E8%AF%A6%E7%BB%86%E6%95%99%E7%A8%8B/Kubernetes%E8%AF%A6%E7%BB%86%E6%95%99%E7%A8%8B.md#4-%E5%AE%9E%E6%88%98%E5%85%A5%E9%97%A8",target:"_blank",rel:"noopener noreferrer"}},[s._v("原文链接"),e("OutboundLink")],1),s._v(" "),e("a",{attrs:{href:"https://www.bilibili.com/video/BV1Qv41167ck",target:"_blank",rel:"noopener noreferrer"}},[s._v("视频教程"),e("OutboundLink")],1)]),s._v(" "),e("p",[s._v("本章节将介绍如何在kubernetes集群中部署一个nginx服务，并且能够对其进行访问。")]),s._v(" "),e("h2",{attrs:{id:"_4-1-namespace"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-namespace"}},[s._v("#")]),s._v(" 4.1 Namespace")]),s._v(" "),e("p",[s._v("Namespace是kubernetes系统中的一种非常重要资源，它的主要作用是用来实现"),e("strong",[s._v("多套环境的资源隔离")]),s._v("或者"),e("strong",[s._v("多租户的资源隔离")]),s._v("。")]),s._v(" "),e("p",[s._v('默认情况下，kubernetes集群中的所有的Pod都是可以相互访问的。但是在实际中，可能不想让两个Pod之间进行互相的访问，那此时就可以将两个Pod划分到不同的namespace下。kubernetes通过将集群内部的资源分配到不同的Namespace中，可以形成逻辑上的"组"，以方便不同的组的资源进行隔离使用和管理。')]),s._v(" "),e("p",[s._v("可以通过kubernetes的授权机制，将不同的namespace交给不同租户进行管理，这样就实现了多租户的资源隔离。此时还能结合kubernetes的资源配额机制，限定不同租户能占用的资源，例如CPU使用量、内存使用量等等，来实现租户可用资源的管理。")]),s._v(" "),e("p",[e("img",{attrs:{src:n(556),alt:"image-20200407100850484"}})]),s._v(" "),e("p",[s._v("kubernetes在集群启动之后，会默认创建几个namespace")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("kubectl get namespace\n\nNAME              STATUS   AGE\ndefault           Active   45h     "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  所有未指定Namespace的对象都会被分配在default命名空间")]),s._v("\nkube-node-lease   Active   45h     "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  集群节点之间的心跳维护，v1.13开始引入")]),s._v("\nkube-public       Active   45h     "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  此命名空间下的资源可以被所有人访问（包括未认证用户）")]),s._v("\nkube-system       Active   45h     "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  所有由Kubernetes系统创建的资源都处于这个命名空间")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("p",[s._v("下面来看namespace资源的具体操作：")]),s._v(" "),e("h3",{attrs:{id:"_4-1-1-查看"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-1-查看"}},[s._v("#")]),s._v(" 4.1.1 "),e("strong",[s._v("查看")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1 查看所有的ns  命令：kubectl get ns")]),s._v("\nkubectl get ns\n\nNAME              STATUS   AGE\ndefault           Active   45h\nkube-node-lease   Active   45h\nkube-public       Active   45h     \nkube-system       Active   45h     \n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2 查看指定的ns   命令：kubectl get ns ns名称")]),s._v("\nkubectl get ns default\n\nNAME      STATUS   AGE\ndefault   Active   45h\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3 指定输出格式  命令：kubectl get ns ns名称  -o 格式参数")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubernetes支持的格式有很多，比较常见的是wide、json、yaml")]),s._v("\nkubectl get ns default -o yaml\n\napiVersion: v1\nkind: Namespace\nmetadata:\n  creationTimestamp: "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2021-10-30T05:29:36Z"')]),s._v("\n  labels:\n    kubernetes.io/metadata.name: default\n  name: default\n  resourceVersion: "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"204"')]),s._v("\n  uid: c89bf2fe-608e-4e4f-bf67-490ca063683e\nspec:\n  finalizers:\n  - kubernetes\nstatus:\n  phase: Active\n  \n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 4 查看ns详情  命令：kubectl describe ns ns名称")]),s._v("\nkubectl describe ns default\n\nName:         default\nLabels:       "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nAnnotations:  "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nStatus:       Active  "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Active 命名空间正在使用中  Terminating 正在删除命名空间")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Resource Quota 针对 namespace 做的资源限制")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# LimitRange 针对 namespace 中的每个组件做的资源限制")]),s._v("\nNo resource quota.\nNo LimitRange resource.\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br")])]),e("h3",{attrs:{id:"_4-1-2-创建"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-2-创建"}},[s._v("#")]),s._v(" 4.1.2 "),e("strong",[s._v("创建")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建namespace")]),s._v("\nkubectl create ns dev\n\nnamespace/dev created\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h3",{attrs:{id:"_4-1-3-删除"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-3-删除"}},[s._v("#")]),s._v(" 4.1.3 "),e("strong",[s._v("删除")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除namespace")]),s._v("\nkubectl delete ns dev\n\nnamespace "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dev"')]),s._v(" deleted\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h3",{attrs:{id:"_4-1-4-配置方式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-4-配置方式"}},[s._v("#")]),s._v(" 4.1.4 "),e("strong",[s._v("配置方式")])]),s._v(" "),e("p",[s._v("首先准备一个yaml文件：ns-dev.yaml")]),s._v(" "),e("div",{staticClass:"language-yaml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Namespace\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" dev\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("p",[s._v("然后就可以执行对应的创建和删除命令了：")]),s._v(" "),e("p",[s._v("创建："),e("code",[s._v("kubectl create -f ns-dev.yaml")])]),s._v(" "),e("p",[s._v("删除："),e("code",[s._v("kubectl delete -f ns-dev.yaml")])]),s._v(" "),e("h2",{attrs:{id:"_4-2-pod"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-pod"}},[s._v("#")]),s._v(" 4.2 Pod")]),s._v(" "),e("p",[s._v("Pod是kubernetes集群进行管理的最小单元，程序要运行必须部署在容器中，而容器必须存在于Pod中。")]),s._v(" "),e("p",[s._v("Pod可以认为是容器的封装，一个Pod中可以存在一个或者多个容器。")]),s._v(" "),e("p",[e("img",{attrs:{src:n(557),alt:"image-20200407121501907"}})]),s._v(" "),e("p",[s._v("kubernetes在集群启动之后，集群中的各个组件也都是以Pod方式运行的。可以通过下面命令查看：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("kubectl get pod -n kube-system\n\nNAMESPACE     NAME                             READY   STATUS    RESTARTS   AGE\nkube-system   coredns-6955765f44-68g6v         "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          2d1h\nkube-system   coredns-6955765f44-cs5r8         "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          2d1h\nkube-system   etcd-master                      "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          2d1h\nkube-system   kube-apiserver-master            "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          2d1h\nkube-system   kube-controller-manager-master   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          2d1h\nkube-system   kube-flannel-ds-amd64-47r25      "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          2d1h\nkube-system   kube-flannel-ds-amd64-ls5lh      "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          2d1h\nkube-system   kube-proxy-685tk                 "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          2d1h\nkube-system   kube-proxy-87spt                 "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          2d1h\nkube-system   kube-scheduler-master            "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          2d1h\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br")])]),e("h3",{attrs:{id:"_4-2-1-创建并运行"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-1-创建并运行"}},[s._v("#")]),s._v(" 4.2.1 创建并运行")]),s._v(" "),e("p",[s._v("kubernetes没有提供单独运行Pod的命令，都是通过Pod控制器来实现的")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 命令格式： kubectl run (pod控制器名称) [参数] ")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --image  指定Pod的镜像")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --port   指定端口")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --namespace  指定namespace")]),s._v("\nkubectl run nginx --image"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx:latest --port"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" --namespace dev\n\npod/nginx created\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h3",{attrs:{id:"_4-2-2-查看pod信息"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-2-查看pod信息"}},[s._v("#")]),s._v(" 4.2.2 查看pod信息")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看Pod基本信息")]),s._v("\nkubectl get pods -n dev -o wide\n\nNAME    READY   STATUS    RESTARTS   AGE     IP           NODE            NOMINATED NODE   READINESS GATES\nnginx   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          2m36s   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.244")]),s._v(".4.8   centos7-node2   "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("           "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看Pod的详细信息")]),s._v("\nkubectl describe pod nginx -n dev\n\nName:         nginx\nNamespace:    dev\nPriority:     "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nNode:         centos7-node2/192.168.85.132\nStart Time:   Sat, "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v(" Oct "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(":49:04 +0800\nLabels:       "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("run")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx\nAnnotations:  "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nStatus:       Running\nIP:           "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.244")]),s._v(".4.8\nIPs:\n  IP:  "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.244")]),s._v(".4.8\nContainers:\n  nginx:\n    Container ID:   docker://b43ffdea69838700bc2a2dcccd3f28addd1ab1480d3483c7716702f6e2be1c51\n    Image:          nginx:latest\n    Image ID:       docker-pullable://nginx@sha256:644a70516a26004c97d0d85c7fe1d0c3a67ea8ab7ddf4aff193d9f301670cf36\n    Port:           "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/TCP\n    Host Port:      "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("/TCP\n    State:          Running\n      Started:      Sat, "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v(" Oct "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(":49:07 +0800\n    Ready:          True\n    Restart Count:  "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n    Environment:    "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n    Mounts:\n      /var/run/secrets/kubernetes.io/serviceaccount from kube-api-access-f8qnf "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ro"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nConditions:\n  Type              Status\n  Initialized       True \n  Ready             True \n  ContainersReady   True \n  PodScheduled      True \nVolumes:\n  kube-api-access-f8qnf:\n    Type:                    Projected "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("a volume that contains injected data from multiple sources"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    TokenExpirationSeconds:  "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3607")]),s._v("\n    ConfigMapName:           kube-root-ca.crt\n    ConfigMapOptional:       "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("nil"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n    DownwardAPI:             "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\nQoS Class:                   BestEffort\nNode-Selectors:              "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nTolerations:                 node.kubernetes.io/not-ready:NoExecute "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("op")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Exists "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" 300s\n                             node.kubernetes.io/unreachable:NoExecute "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("op")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Exists "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" 300s\nEvents:\n  Type    Reason     Age   From               Message\n  ----    ------     ----  ----               -------\n  Normal  Scheduled  53s   default-scheduler  Successfully assigned dev/nginx to centos7-node2\n  Normal  Pulling    51s   kubelet            Pulling image "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx:latest"')]),s._v("\n  Normal  Pulled     50s   kubelet            Successfully pulled image "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx:latest"')]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".57113276s\n  Normal  Created    50s   kubelet            Created container nginx\n  Normal  Started    50s   kubelet            Started container nginx\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br"),e("span",{staticClass:"line-number"},[s._v("59")]),e("br")])]),e("h3",{attrs:{id:"_4-2-3-访问pod"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-3-访问pod"}},[s._v("#")]),s._v(" 4.2.3 访问Pod")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 获取podIP")]),s._v("\nkubectl get pods -n dev -o wide\n\nNAME    READY   STATUS    RESTARTS   AGE     IP           NODE            NOMINATED NODE   READINESS GATES\nnginx   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          8m39s   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.244")]),s._v(".4.8   centos7-node2   "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("           "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#访问POD")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" http://10.244.4.8:80\n \n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("DOCTYPE html"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("html"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("head"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\t"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("title"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("Welcome to nginx"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/title"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/head"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("body"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\t"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("p"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("em"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("Thank you "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" using nginx."),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/em"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/p"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/body"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/html"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br")])]),e("h3",{attrs:{id:"_4-2-4-删除指定pod"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-4-删除指定pod"}},[s._v("#")]),s._v(" 4.2.4 删除指定Pod")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除指定Pod")]),s._v("\nkubectl delete pod nginx -n dev\n\npod "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx"')]),s._v(" deleted\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 此时，显示删除Pod成功，但是再查询，发现又新产生了一个 ")]),s._v("\nkubectl get pods -n dev\n\nNAME    READY   STATUS    RESTARTS   AGE\nnginx   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          21s\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这是因为当前Pod是由Pod控制器创建的，控制器会监控Pod状况，一旦发现Pod死亡，会立即重建")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 此时要想删除Pod，必须删除Pod控制器")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 先来查询一下当前namespace下的Pod控制器")]),s._v("\nkubectl get deploy -n  dev\n\nNAME    READY   UP-TO-DATE   AVAILABLE   AGE\nnginx   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("            "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("           9m7s\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 接下来，删除此PodPod控制器")]),s._v("\nkubectl delete deploy nginx -n dev\n\ndeployment.apps "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx"')]),s._v(" deleted\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 稍等片刻，再查询Pod，发现Pod被删除了")]),s._v("\nkubectl get pods -n dev\n\nNo resources found "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" dev namespace.\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br")])]),e("h3",{attrs:{id:"_4-2-5-配置操作"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-5-配置操作"}},[s._v("#")]),s._v(" 4.2.5 配置操作")]),s._v(" "),e("p",[s._v("创建一个pod-nginx.yaml，内容如下：")]),s._v(" "),e("div",{staticClass:"language-yaml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Pod\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("namespace")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" dev\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containers")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("latest\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" pod\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("port\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containerPort")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("protocol")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" TCP\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br")])]),e("p",[s._v("然后就可以执行对应的创建和删除命令了：")]),s._v(" "),e("p",[s._v("创建："),e("code",[s._v("kubectl create -f pod-nginx.yaml")])]),s._v(" "),e("p",[s._v("删除："),e("code",[s._v("kubectl delete -f pod-nginx.yaml")])]),s._v(" "),e("h2",{attrs:{id:"_4-3-label"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-label"}},[s._v("#")]),s._v(" 4.3 Label")]),s._v(" "),e("p",[s._v("Label是kubernetes系统中的一个重要概念。它的作用就是在资源上添加标识，用来对它们进行区分和选择。")]),s._v(" "),e("p",[s._v("Label的特点：")]),s._v(" "),e("ul",[e("li",[s._v("一个Label会以key/value键值对的形式附加到各种对象上，如Node、Pod、Service等等")]),s._v(" "),e("li",[s._v("一个资源对象可以定义任意数量的Label ，同一个Label也可以被添加到任意数量的资源对象上去")]),s._v(" "),e("li",[s._v("Label通常在资源对象定义时确定，当然也可以在对象创建后动态添加或者删除")])]),s._v(" "),e("p",[s._v("可以通过Label实现资源的多维度分组，以便灵活、方便地进行资源分配、调度、配置、部署等管理工作。")]),s._v(" "),e("blockquote",[e("p",[s._v("一些常用的Label 示例如下：")]),s._v(" "),e("ul",[e("li",[s._v('版本标签："version":"release", "version":"stable"......')]),s._v(" "),e("li",[s._v('环境标签："environment":"dev"，"environment":"test"，"environment":"pro"')]),s._v(" "),e("li",[s._v('架构标签："tier":"frontend"，"tier":"backend"')])])]),s._v(" "),e("p",[s._v("标签定义完毕之后，还要考虑到标签的选择，这就要使用到Label Selector，即：\nLabel用于给某个资源对象定义标识\nLabel Selector用于查询和筛选拥有某些标签的资源对象")]),s._v(" "),e("p",[s._v("当前有两种Label Selector：")]),s._v(" "),e("ul",[e("li",[s._v("基于等式的Label Selector\n"),e("ul",[e("li",[e("code",[s._v("name = slave")]),s._v(': 选择所有包含Label中key="name"且value="slave"的对象')]),s._v(" "),e("li",[e("code",[s._v("env != production")]),s._v(': 选择所有包括Label中的key="env"且value不等于"production"的对象')])])]),s._v(" "),e("li",[s._v("基于集合的Label Selector\n"),e("ul",[e("li",[e("code",[s._v("name in (master, slave)")]),s._v(': 选择所有包含Label中的key="name"且value="master"或"slave"的对象')]),s._v(" "),e("li",[e("code",[s._v("name not in (frontend)")]),s._v(': 选择所有包含Label中的key="name"且value不等于"frontend"的对象')])])])]),s._v(" "),e("p",[s._v('标签的选择条件可以使用多个，此时将多个Label Selector进行组合，使用逗号","进行分隔即可。例如：')]),s._v(" "),e("ul",[e("li",[e("code",[s._v("name=slave,env!=production")])]),s._v(" "),e("li",[e("code",[s._v("name not in (frontend),env!=production")])])]),s._v(" "),e("h3",{attrs:{id:"_4-3-1-命令方式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-1-命令方式"}},[s._v("#")]),s._v(" 4.3.1 命令方式")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 为pod资源打标签")]),s._v("\nkubectl label pod nginx-pod "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("version")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.0")]),s._v(" -n dev\n\npod/nginx-pod labeled\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 为pod资源更新标签")]),s._v("\nkubectl label pod nginx-pod "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("version")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.0")]),s._v(" -n dev --overwrite\n\npod/nginx-pod labeled\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看标签")]),s._v("\nkubectl get pod nginx-pod  -n dev --show-labels\n\nNAME        READY   STATUS    RESTARTS   AGE   LABELS\nnginx-pod   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          10m   "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("version")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.0")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 筛选标签")]),s._v("\nkubectl get pod -n dev -l "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("version")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.0")]),s._v("  --show-labels\n\nNAME        READY   STATUS    RESTARTS   AGE   LABELS\nnginx-pod   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          17m   "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("version")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.0")]),s._v("\n\nkubectl get pod -n dev -l version"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.0")]),s._v(" --show-labels\n\nNo resources found "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" dev namespace.\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除标签")]),s._v("\nkubectl label pod nginx-pod version- -n dev\n\npod/nginx-pod labeled\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br")])]),e("h3",{attrs:{id:"_4-3-2-配置方式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-2-配置方式"}},[s._v("#")]),s._v(" 4.3.2 配置方式")]),s._v(" "),e("div",{staticClass:"language-yaml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Pod\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("namespace")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" dev\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("labels")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3.0"')]),s._v(" \n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("env")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test"')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containers")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("latest\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" pod\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("port\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containerPort")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("protocol")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" TCP\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br")])]),e("p",[s._v("然后就可以执行对应的更新命令了："),e("code",[s._v("kubectl apply -f pod-nginx.yaml")])]),s._v(" "),e("h2",{attrs:{id:"_4-4-deployment"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-deployment"}},[s._v("#")]),s._v(" 4.4 Deployment")]),s._v(" "),e("p",[s._v("在kubernetes中，Pod是最小的控制单元，但是kubernetes很少直接控制Pod，一般都是通过Pod控制器来完成的。Pod控制器用于pod的管理，确保pod资源符合预期的状态，当pod的资源出现故障时，会尝试进行重启或重建pod。")]),s._v(" "),e("p",[s._v("在kubernetes中Pod控制器的种类有很多，本章节只介绍一种：Deployment。")]),s._v(" "),e("p",[e("img",{attrs:{src:n(558),alt:"image-20200408193950807"}})]),s._v(" "),e("h3",{attrs:{id:"_4-4-1-命令操作"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-1-命令操作"}},[s._v("#")]),s._v(" 4.4.1 命令操作")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 命令格式: kubectl create deployment 名称  [参数] ")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --image  指定pod的镜像")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --port   指定端口")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --replicas  指定创建pod数量")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --namespace  指定namespace")]),s._v("\nkubectl create deployment nginx --image"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx:latest --port"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" --replicas"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" -n dev\n\ndeployment.apps/nginx created\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看创建的Pod")]),s._v("\nkubectl get pods -n dev\n\nNAME                     READY   STATUS    RESTARTS   AGE\nnginx-5ff7956ff6-6k8cb   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          19s\nnginx-5ff7956ff6-jxfjt   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          19s\nnginx-5ff7956ff6-v6jqw   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          19s\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看deployment的信息")]),s._v("\nkubectl get deploy -n dev\n\nNAME    READY   UP-TO-DATE   AVAILABLE   AGE\nnginx   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("/3     "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("            "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("           2m42s\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# UP-TO-DATE：成功升级的副本数量")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# AVAILABLE：可用副本的数量")]),s._v("\nkubectl get deploy -n dev -o wide\n\nNAME    READY UP-TO-DATE  AVAILABLE   AGE     CONTAINERS   IMAGES              SELECTOR\nnginx   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("/3     "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("         "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("           2m51s   nginx        nginx:latest        "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("app")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看deployment的详细信息")]),s._v("\nkubectl describe deploy nginx -n dev\n\nName:                   nginx\nNamespace:              dev\nCreationTimestamp:      Wed, 08 May "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":14:14 +0800\nLabels:                 "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("run")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx\nAnnotations:            deployment.kubernetes.io/revision: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nSelector:               "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("run")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx\nReplicas:               "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" desired "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" updated "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" total "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" available "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" unavailable\nStrategyType:           RollingUpdate\nMinReadySeconds:        "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nRollingUpdateStrategy:  "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v("% max unavailable, "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v("% max surge\nPod Template:\n  Labels:  "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("run")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx\n  Containers:\n   nginx:\n    Image:        nginx:latest\n    Port:         "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/TCP\n    Host Port:    "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("/TCP\n    Environment:  "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n    Mounts:       "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n  Volumes:        "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nConditions:\n  Type           Status  Reason\n  ----           ------  ------\n  Available      True    MinimumReplicasAvailable\n  Progressing    True    NewReplicaSetAvailable\nOldReplicaSets:  "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nNewReplicaSet:   nginx-5ff7956ff6 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("/3 replicas created"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nEvents:\n  Type    Reason             Age    From                   Message\n  ----    ------             ----   ----                   -------\n  Normal  ScalingReplicaSet  5m43s  deployment-controller  Scaled up replicaset nginx-5ff7956ff6 to "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n  \n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除 ")]),s._v("\nkubectl delete deploy nginx -n dev\n\ndeployment.apps "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx"')]),s._v(" deleted\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br"),e("span",{staticClass:"line-number"},[s._v("59")]),e("br"),e("span",{staticClass:"line-number"},[s._v("60")]),e("br"),e("span",{staticClass:"line-number"},[s._v("61")]),e("br"),e("span",{staticClass:"line-number"},[s._v("62")]),e("br"),e("span",{staticClass:"line-number"},[s._v("63")]),e("br"),e("span",{staticClass:"line-number"},[s._v("64")]),e("br"),e("span",{staticClass:"line-number"},[s._v("65")]),e("br"),e("span",{staticClass:"line-number"},[s._v("66")]),e("br"),e("span",{staticClass:"line-number"},[s._v("67")]),e("br"),e("span",{staticClass:"line-number"},[s._v("68")]),e("br"),e("span",{staticClass:"line-number"},[s._v("69")]),e("br")])]),e("h3",{attrs:{id:"_4-4-2-配置操作"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-2-配置操作"}},[s._v("#")]),s._v(" 4.4.2 配置操作")]),s._v(" "),e("p",[s._v("创建一个deploy-nginx.yaml，内容如下：")]),s._v(" "),e("div",{staticClass:"language-yaml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" apps/v1\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Deployment\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("namespace")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" dev\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("replicas")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("selector")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("matchLabels")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("run")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("template")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("labels")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("run")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containers")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("latest\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containerPort")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("protocol")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" TCP\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br")])]),e("p",[s._v("然后就可以执行对应的创建和删除命令了：")]),s._v(" "),e("p",[s._v("创建："),e("code",[s._v("kubectl create -f deploy-nginx.yaml")])]),s._v(" "),e("p",[s._v("删除："),e("code",[s._v("kubectl delete -f deploy-nginx.yaml")])]),s._v(" "),e("h2",{attrs:{id:"_4-5-service"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-5-service"}},[s._v("#")]),s._v(" 4.5 Service")]),s._v(" "),e("p",[s._v("通过上节课的学习，已经能够利用Deployment来创建一组Pod来提供具有高可用性的服务。")]),s._v(" "),e("p",[s._v("虽然每个Pod都会分配一个单独的Pod IP，然而却存在如下两问题：")]),s._v(" "),e("ul",[e("li",[s._v("Pod IP 会随着Pod的重建产生变化")]),s._v(" "),e("li",[s._v("Pod IP 仅仅是集群内可见的虚拟IP，外部无法访问")])]),s._v(" "),e("p",[s._v("这样对于访问这个服务带来了难度。因此，kubernetes设计了Service来解决这个问题。")]),s._v(" "),e("p",[s._v("Service可以看作是一组同类Pod"),e("strong",[s._v("对外的访问接口")]),s._v("。借助Service，应用可以方便地实现服务发现和负载均衡。")]),s._v(" "),e("p",[e("img",{attrs:{src:n(559),alt:"image-20200408194716912"}})]),s._v(" "),e("h3",{attrs:{id:"_4-5-1-创建集群内部可访问的service"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-5-1-创建集群内部可访问的service"}},[s._v("#")]),s._v(" 4.5.1 创建集群内部可访问的Service")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 暴露Service")]),s._v("\nkubectl expose deploy nginx --name"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("svc-nginx1 --type"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ClusterIP --port"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" --target-port"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" -n dev\n\nservice/svc-nginx1 exposed\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看service")]),s._v("\nkubectl get svc svc-nginx1 -n dev -o wide\n\nNAME         TYPE        CLUSTER-IP      EXTERNAL-IP   PORT"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("S"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("   AGE   SELECTOR\nsvc-nginx1   ClusterIP   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.110")]),s._v(".89.103   "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("        "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/TCP    24s   "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("run")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这里产生了一个CLUSTER-IP，这就是service的IP，在Service的生命周期中，这个地址是不会变动的")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可以通过这个IP访问当前service对应的POD")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.110")]),s._v(".89.103:80\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("DOCTYPE html"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("html"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("head"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("title"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("Welcome to nginx"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/title"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/head"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("body"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("h"),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("1")]),s._v(">")]),s._v("Welcome to nginx"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/h"),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("1")]),s._v(">")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/body"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/html"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br")])]),e("h3",{attrs:{id:"_4-5-2-创建集群外部也可访问的service"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-5-2-创建集群外部也可访问的service"}},[s._v("#")]),s._v(" 4.5.2 创建集群外部也可访问的Service")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 上面创建的Service的type类型为ClusterIP，这个ip地址只用集群内部可访问")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果需要创建外部也可以访问的Service，需要修改type为NodePort")]),s._v("\nkubectl expose deploy nginx --name"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("svc-nginx2 --type"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("NodePort --port"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" --target-port"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" -n dev\n\nservice/svc-nginx2 exposed\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 此时查看，会发现出现了NodePort类型的Service，而且有一对Port（80:30871/TC）")]),s._v("\nkubectl get svc  svc-nginx2  -n dev -o wide\n\nNAME         TYPE       CLUSTER-IP     EXTERNAL-IP   PORT"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("S"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("        AGE   SELECTOR\nsvc-nginx2   NodePort   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.96")]),s._v(".250.54   "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("        "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(":30871/TCP   10s   "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("run")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx\n\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 接下来就可以通过集群外的主机访问 节点IP:30871访问服务了")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 例如在的电脑主机上通过浏览器访问下面的地址")]),s._v("\nhttp://192.168.85.131:30871\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br")])]),e("h3",{attrs:{id:"_4-5-3-删除service"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-5-3-删除service"}},[s._v("#")]),s._v(" 4.5.3 删除Service")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("kubectl delete svc svc-nginx-1 -n dev \n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"svc-nginx-1"')]),s._v(" deleted\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h3",{attrs:{id:"_4-5-4-配置方式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-5-4-配置方式"}},[s._v("#")]),s._v(" 4.5.4 配置方式")]),s._v(" "),e("p",[s._v("创建一个svc-nginx.yaml，内容如下：")]),s._v(" "),e("div",{staticClass:"language-yaml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Service\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" svc"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("nginx\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("namespace")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" dev\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("clusterIP")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 10.109.179.231 "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#固定svc的内网ip")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("port")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("protocol")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" TCP\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("targetPort")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("selector")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("run")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("type")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ClusterIP\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br")])]),e("p",[s._v("然后就可以执行对应的创建和删除命令了：")]),s._v(" "),e("p",[s._v("创建："),e("code",[s._v("kubectl create -f svc-nginx.yaml")])]),s._v(" "),e("p",[s._v("删除："),e("code",[s._v("kubectl delete -f svc-nginx.yaml")])]),s._v(" "),e("blockquote",[e("p",[e("strong",[s._v("小结")])]),s._v(" "),e("p",[s._v("至此，已经掌握了Namespace、Pod、Deployment、Service资源的基本操作，有了这些操作，就可以在kubernetes集群中实现一个服务的简单部署和访问了，但是如果想要更好的使用kubernetes，就需要深入学习这几种资源的细节和原理。")])])])}),[],!1,null,null,null);a.default=t.exports}}]);