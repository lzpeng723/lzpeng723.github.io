import{_ as r,r as o,o as d,c,b as e,d as a,e as n,a as t}from"./app-rBywrD27.js";const i={},l=t(`<h2 id="伪装成win10专业版" tabindex="-1"><a class="header-anchor" href="#伪装成win10专业版" aria-hidden="true">#</a> 伪装成win10专业版</h2><p>以管理员身份打开cmd。 执行如下命令：</p><div class="language-batch line-numbers-mode" data-ext="batch"><pre class="language-batch"><code><span class="token command"><span class="token keyword">REG</span> ADD <span class="token string">&quot;HKEY_LOCAL_MACHINE\\software\\Microsoft\\Windows NT\\CurrentVersion&quot;</span> <span class="token parameter attr-name">/v</span> EditionId <span class="token parameter attr-name">/T</span> REG_EXPAND_SZ <span class="token parameter attr-name">/d</span> Professional <span class="token parameter attr-name">/F</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="开启hyper-v" tabindex="-1"><a class="header-anchor" href="#开启hyper-v" aria-hidden="true">#</a> 开启Hyper-V</h2><h3 id="一、如果hyper-v完全禁用或未安装" tabindex="-1"><a class="header-anchor" href="#一、如果hyper-v完全禁用或未安装" aria-hidden="true">#</a> 一、如果Hyper-V完全禁用或未安装</h3><p>新建hyperv.cmd文件，内容如下：</p><div class="language-batch line-numbers-mode" data-ext="batch"><pre class="language-batch"><code><span class="token command"><span class="token keyword">pushd</span> <span class="token string">&quot;%~dp0&quot;</span></span>

<span class="token command"><span class="token keyword">dir</span> <span class="token parameter attr-name">/b</span> <span class="token variable">%SystemRoot%</span>\\servicing\\Packages\\*Hyper<span class="token parameter attr-name">-V</span>*.mum &gt;hyper<span class="token parameter attr-name">-v</span>.txt</span>

<span class="token command"><span class="token keyword">for</span> <span class="token parameter attr-name">/f</span> <span class="token variable">%%i</span> <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token punctuation">&#39;</span>findstr <span class="token parameter attr-name">/i</span> . hyper<span class="token parameter attr-name">-v</span>.txt <span class="token number">2</span>^&gt;nul<span class="token punctuation">&#39;</span><span class="token punctuation">)</span> <span class="token keyword">do</span></span> <span class="token command"><span class="token keyword">dism</span> <span class="token parameter attr-name">/online</span> <span class="token parameter attr-name">/norestart</span> /add-package:<span class="token string">&quot;%SystemRoot%\\servicing\\Packages\\%%i&quot;</span></span>

<span class="token command"><span class="token keyword">del</span> hyper<span class="token parameter attr-name">-v</span>.txt</span>

<span class="token command"><span class="token keyword">Dism</span> <span class="token parameter attr-name">/online</span> /enable-feature <span class="token parameter attr-name">/featurename<span class="token punctuation">:</span></span>Microsoft-Hyper<span class="token parameter attr-name">-V</span>-All <span class="token parameter attr-name">/LimitAccess</span> <span class="token parameter attr-name">/ALL</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>以管理员身份执行<code>hyperv.cmd</code>文件。 如果系统要你重启，便重启。 在控制面板-&gt;程序和功能-&gt;启用或关闭Windows功能打开Hyper-V。</p><h3 id="二、如果已启用hyper-v功能但不起作用" tabindex="-1"><a class="header-anchor" href="#二、如果已启用hyper-v功能但不起作用" aria-hidden="true">#</a> 二、如果已启用Hyper-V功能但不起作用</h3><p>使用Hypervisor启用</p><div class="language-batch line-numbers-mode" data-ext="batch"><pre class="language-batch"><code><span class="token command"><span class="token keyword">bcdedit</span> <span class="token parameter attr-name">/set</span> hypervisorlaunchtype auto</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>现在重新启动系统，然后重试。</p><p>如果问题仍然存在，则系统上的Hyper-V可能已损坏，因此进入控制面板 - &gt; [程序] - &gt; [Windows功能]，完全取消选中所有与Hyper-V相关的组件，重启系统。 再次启用Hyper-V，重新开始。</p><h2 id="注意" tabindex="-1"><a class="header-anchor" href="#注意" aria-hidden="true">#</a> 注意</h2><p>Hyper-V需要硬件虚拟化作为先决条件。确保您的PC支持它，如果是，但仍然无法正常工作，可能是您的BIOS未正确配置且此功能已禁用。在这种情况下，请检查，启用它并重试。根据所使用的平台，可以根据不同的名称报告虚拟化功能（例如，如果您没有看到明确使用虚拟化标签的任何选项，则必须在Intel上检查SVM功能状态，在VT-x功能状态下）。</p><p>Hyper-V 只能安装某些版本，例如： Windows 10企业版; Windows 10专业版; Windows 10教育。 Hyper-V 无法安装在更便宜或移动的Windows版本上，例如： Windows 10 Home; Windows 10移动版; Windows 10移动企业版。</p><h2 id="安装docker-desktop" tabindex="-1"><a class="header-anchor" href="#安装docker-desktop" aria-hidden="true">#</a> 安装Docker Desktop</h2>`,17),p={href:"https://www.docker.com/products/docker-desktop",target:"_blank",rel:"noopener noreferrer"},u=e("p",null,[a("下载后直接安装，安装时注意取消勾选window容器（默认不会勾选）。 Docker安装成功后，执行cmd命令"),e("code",null,"docker version"),a("。")],-1),h=e("h3",{id:"配置镜像加速",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#配置镜像加速","aria-hidden":"true"},"#"),a(" 配置镜像加速")],-1),k={href:"https://help.aliyun.com/document_detail/60750.html",target:"_blank",rel:"noopener noreferrer"},m=t(`<p>网易加速器：http://hub-mirror.c.163.com</p><p>官方中国加速器：https://registry.docker-cn.com</p><p>七牛云加速器：https://reg-mirror.qiniu.com</p><p>科大镜像(ustc) 的镜像：https://docker.mirrors.ustc.edu.cn</p><p>daocloud：https://www.daocloud.io/mirror#accelerator-doc（注册后使用）</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token property">&quot;registry-mirrors&quot;</span><span class="token operator">:</span>  <span class="token punctuation">[</span>
    <span class="token string">&quot;http://hub-mirror.c.163.com&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;https://docker.mirrors.ustc.edu.cn&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;https://registry.docker-cn.com&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;https://reg-mirror.qiniu.com&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;https://dockerhub.azk8s.cn&quot;</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="修改docker文件存储位置" tabindex="-1"><a class="header-anchor" href="#修改docker文件存储位置" aria-hidden="true">#</a> 修改docker文件存储位置</h2><h3 id="使用wsl修改docker文件存储位置" tabindex="-1"><a class="header-anchor" href="#使用wsl修改docker文件存储位置" aria-hidden="true">#</a> 使用WSL修改docker文件存储位置</h3><p>WSL2模式下docker-desktop-data vm磁盘映像通常位于以下位置： <code>C:\\Users\\&lt;User&gt;\\AppData\\Local\\Docker\\wsl\\data\\ext4.vhdx</code> 按照以下说明将其重新定位到其他驱动器/目录，并保留所有现有的Docker数据。</p><ul><li>首先，右键单击Docker Desktop图标关闭Docker桌面，然后选择退出Docker桌面，然后，打开命令提示符：<div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>wsl --list -v
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li>您应该能够看到，确保两个状态都已停止。</li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>NAME                   STATE           VERSION
* docker-desktop         Stopped         2
 docker-desktop-data    Stopped         2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,11),v={class:"custom-container tip"},b=e("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},[e("g",{fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("circle",{cx:"12",cy:"12",r:"9"}),e("path",{d:"M12 8h.01"}),e("path",{d:"M11 12h1v4h1"})])],-1),w=e("p",{class:"custom-container-title"},"TIP",-1),g={href:"https://docs.microsoft.com/en-us/windows/wsl/compare-versions#expanding-the-size-of-your-wsl-2-virtual-hard-disk",target:"_blank",rel:"noopener noreferrer"},x=t(`<ul><li>将<code>docker-desktop-data</code>导出到文件中(备份image及相关文件)，使用如下命令</li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>D:
md wsl2\\docker
wsl --export docker-desktop-data &quot;D:\\\\wsl2\\\\docker\\\\docker-desktop-data.tar&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>从wsl取消注册<code>docker-desktop-data</code>，请注意<code>C:\\Users\\&lt;User&gt;\\AppData\\Local\\Docker\\wsl\\data\\ext4.vhdx</code>文件将被自动删除。</li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>wsl --unregister docker-desktop-data
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>将导出的<code>docker-desktop-data</code>再导入回wsl，并设置我们想要的路径，即新的镜像及各种docker使用的文件的挂载目录，我这里设置到<code>D:\\\\docker\\\\wsl</code></li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>wsl --import docker-desktop-data &quot;D:\\\\wsl2\\\\docker\\\\wsl&quot; &quot;D:\\\\wsl2\\\\docker\\\\docker-desktop-data.tar&quot; --version 2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>命令执行完毕，就能再目录下看到文件了，这时次启动<code>Docker Desktop</code>，可以正常工作了</li></ul><h3 id="如何验证有效" tabindex="-1"><a class="header-anchor" href="#如何验证有效" aria-hidden="true">#</a> 如何验证有效</h3><p>修改前记录 <code>C:\\Users\\&lt;User&gt;\\AppData\\Local\\Docker\\wsl</code>目录文件大小（大于2G） 修改后，在记录其文件大小（小于200M）和<code>D:\\\\wsl2\\\\docker\\\\wsl</code>（1.47G），然后docker pull任意一个镜像（我下载了nginx、tomcat），再看<code>C:\\Users\\&lt;User&gt;\\AppData\\Local\\Docker\\wsl</code>目录无变化，而<code>D:\\\\wsl2\\\\docker\\\\wsl</code>增大到2.26G</p><p>如果在验证后一切没有问题，则可以删除<code>D:\\\\wsl2\\\\docker\\\\docker-desktop-data.tar</code>文件，记住可不是<code>ext4.vhdx</code>文件，这可是重要文件</p><h2 id="最后" tabindex="-1"><a class="header-anchor" href="#最后" aria-hidden="true">#</a> 最后</h2><h3 id="运行个-hello-world-尝尝鲜" tabindex="-1"><a class="header-anchor" href="#运行个-hello-world-尝尝鲜" aria-hidden="true">#</a> 运行个 Hello World 尝尝鲜</h3><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker run hello-world
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,13),_={href:"https://www.runoob.com/docker",target:"_blank",rel:"noopener noreferrer"},f=t('<h2 id="可能遇到的问题" tabindex="-1"><a class="header-anchor" href="#可能遇到的问题" aria-hidden="true">#</a> 可能遇到的问题</h2><h3 id="docker-for-windows-could-not-read-ca-certificate问题" tabindex="-1"><a class="header-anchor" href="#docker-for-windows-could-not-read-ca-certificate问题" aria-hidden="true">#</a> docker for windows could not read CA certificate问题</h3><p>问题原因: 之前安装过 docker toolbox。</p><p>解决步骤:</p><ul><li>删掉四个docker 的环境变量</li><li>执行cmd命令<code>docker-machine rm default</code></li><li>以管理员身份执行cmd命令<code>@FOR /f &quot;tokens=*&quot; %i IN (&#39;docker-machine env -u&#39;) DO @%i</code></li></ul><h2 id="卸载docker" tabindex="-1"><a class="header-anchor" href="#卸载docker" aria-hidden="true">#</a> 卸载Docker</h2><h3 id="运行卸载程序" tabindex="-1"><a class="header-anchor" href="#运行卸载程序" aria-hidden="true">#</a> 运行卸载程序</h3><h3 id="清除注册表" tabindex="-1"><a class="header-anchor" href="#清除注册表" aria-hidden="true">#</a> 清除注册表</h3><ul><li>按下<code>Window+R</code>唤起命令输入界面，输入<code>regedit</code>打开注册表编辑</li><li>在地址栏输入<code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Docker Desktop</code></li><li>将整个Docker Desktop组点击右键删除</li></ul>',9),y={id:"关闭-hyper-v-和-适用于-linux-的-windows-子系统",tabindex:"-1"},D=e("a",{class:"header-anchor",href:"#关闭-hyper-v-和-适用于-linux-的-windows-子系统","aria-hidden":"true"},"#",-1),q={href:"https://kb.vmware.com/s/article/2146361?lang=zh_CN",target:"_blank",rel:"noopener noreferrer"},V=e("div",{class:"language-text line-numbers-mode","data-ext":"text"},[e("pre",{class:"language-text"},[e("code",null,`bcdedit /set hypervisorlaunchtype off
`)]),e("div",{class:"line-numbers","aria-hidden":"true"},[e("div",{class:"line-number"})])],-1),H=e("p",null,"最后重启电脑",-1);function A(W,C){const s=o("ExternalLinkIcon");return d(),c("div",null,[l,e("p",null,[e("a",p,[a("下载地址"),n(s)])]),u,h,e("p",null,[a("阿里云的加速器：https://<你的ID>.mirror.aliyuncs.com "),e("a",k,[a("申请地址"),n(s)])]),m,e("div",v,[b,w,e("p",null,[a("默认情况下，Docker Desktop for Window会创建如下两个发行版（distro) C:\\Users<User>\\AppData\\Local\\Docker\\wsl docker-desktop (对应distro/ext4.vhdx) docker-desktop-data （对应data/ext4.vhdx） 按官网提示：vhdx文件最大支持256G，超出大小会有异常。当然我的C盘也没那么大"),e("a",g,[a("官方说明"),n(s)])])]),x,e("p",null,[a("好了，Docker 安装完毕，开始愉快的学习 Docker 吧，"),e("a",_,[a("Docker学习教程"),n(s)]),a("。")]),f,e("h3",y,[D,a(),e("a",q,[a("关闭 Hyper-V"),n(s)]),a(" 和 适用于 Linux 的 Windows 子系统")]),V,H])}const E=r(i,[["render",A],["__file","win10-install-Docker.html.vue"]]);export{E as default};
